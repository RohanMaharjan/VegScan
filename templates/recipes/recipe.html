{% extends "base.html" %}
{% block title %}Recipes ¬∑ VegScan{% endblock %}

{% block content %}
<style>
  .recipe-meta-badge {
    display: inline-block;
    background: var(--accent-weak);
    color: var(--accent);
    padding: 0.375rem 0.75rem;
    border-radius: 99px;
    font-size: 0.8rem;
    font-weight: 600;
    margin-right: 0.5rem;
    margin-bottom: 0.5rem;
    text-transform: capitalize;
    white-space: nowrap;
  }
  
  .recipe-meta-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
    gap: 1rem;
    margin-bottom: 1.5rem;
  }
  
  .recipe-meta-item {
    text-align: center;
    padding: 1rem;
    background: linear-gradient(135deg, rgba(255,255,255,0.05) 0%, rgba(255,255,255,0.02) 100%);
    border: 1px solid rgba(255,255,255,0.1);
    border-radius: 1rem;
  }
  
  .recipe-meta-value {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--accent);
    display: block;
  }
  
  .recipe-meta-label {
    font-size: 0.75rem;
    color: #94a3b8;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-top: 0.25rem;
  }
  
  .recipe-instructions {
    line-height: 1.8;
    color: #cbd5e1;
    font-size: 1rem;
    background: linear-gradient(135deg, rgba(255,255,255,0.05) 0%, rgba(255,255,255,0.02) 100%);
    padding: 1.5rem;
    border-radius: 1rem;
    border: 1px solid rgba(255,255,255,0.1);
  }
  
  .ingredient-section {
    display: grid;
    gap: 0.75rem;
  }
  
  .ingredient-item {
    display: flex;
    gap: 1rem;
    padding: 0.75rem;
    background: rgba(255,255,255,0.03);
    border-left: 3px solid var(--accent);
    border-radius: 0.5rem;
    align-items: baseline;
  }
  
  .ingredient-amount {
    flex: 0 0 auto;
    font-weight: 600;
    color: var(--accent);
    min-width: 80px;
  }
  
  .ingredient-name {
    flex: 1;
    color: #cbd5e1;
  }
  
  .recipe-source-btn {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    background: linear-gradient(135deg, var(--accent) 0%, var(--accent-weak) 100%);
    color: #000;
    padding: 0.75rem 1.5rem;
    border-radius: 0.75rem;
    font-weight: 600;
    text-decoration: none;
    transition: all 0.3s ease;
    border: 2px solid var(--accent);
    margin-top: 1.5rem;
  }
  
  .recipe-source-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 20px -5px rgba(0, 0, 0, 0.3);
  }
  
  .recipe-layout {
    display: grid;
    grid-template-columns: 1fr;
    gap: 2rem;
    align-items: start;
  }
  
  .scanned-list strong {
    color: var(--accent);
    font-weight: 700;
  }
</style>

<div class="max-w-6xl mx-auto py-12 px-4">
  <div class="mb-8">
    <h1 class="text-4xl font-display font-bold">Recipe Suggestions</h1>
    <p class="text-slate-400 mt-2">Personalized recipes curated just for your vegetables</p>
  </div>

  {% if not scanned %}
    <div class="rounded-2xl p-8 bg-ai-card/50 border border-white/5">
      <p class="text-slate-300">No vegetables provided. Return to the scanner and capture some vegetables first.</p>
    </div>
  {% else %}
    <div class="rounded-2xl p-6 bg-ai-card/40 border border-white/5 mb-8 scanned-list">
      <p class="text-slate-300">ü•¨ Scanned vegetables: <strong>{{ scanned|join:", " }}</strong></p>
      {% if api_used %}
        <p class="text-slate-400 text-sm mt-2">‚ú® Recipes powered by Spoonacular API</p>
      {% else %}
        <p class="text-slate-400 text-sm mt-2">üìö Using curated local recipes</p>
      {% endif %}
    </div>

    <div class="space-y-12">
      {% for r in recipes %}
        <div class="rounded-2xl bg-gradient-to-br from-ai-card/30 to-ai-card/10 p-8 border border-white/5 recipe-card">
          <!-- Main Recipe Content -->
          <div class="recipe-layout">
            <!-- Content Column -->
            <div>
              <h2 class="text-3xl font-bold text-white mb-4">{{ r.title }}</h2>
              
              <!-- Meta Info Grid -->
              <div class="recipe-meta-grid mb-6">
                <div class="recipe-meta-item">
                  <span class="recipe-meta-value">{{ r.servings|default:"2" }}</span>
                  <span class="recipe-meta-label">Servings</span>
                </div>
                <div class="recipe-meta-item">
                  <span class="recipe-meta-value">{{ r.prepTime|default:"10" }}</span>
                  <span class="recipe-meta-label">Prep (min)</span>
                </div>
                <div class="recipe-meta-item">
                  <span class="recipe-meta-value">{{ r.cookTime|default:"15" }}</span>
                  <span class="recipe-meta-label">Cook (min)</span>
                </div>
              </div>

              <!-- Ingredients -->
              <div class="mb-6">
                <h3 class="text-lg font-semibold text-white mb-3">Ingredients</h3>
                <div class="ingredient-section">
                  {% for ing in r.ingredients %}
                    <div class="ingredient-item">
                      <span class="ingredient-amount">
                        {% if ing.amount %}
                          {{ ing.amount|floatformat:0 }}{% if ing.unit %} {{ ing.unit }}{% endif %}
                        {% else %}
                          To taste
                        {% endif %}
                      </span>
                      <span class="ingredient-name">{{ ing.name }}</span>
                    </div>
                  {% endfor %}
                </div>
                <p class="text-xs text-slate-400 mt-3 italic">üìù Note: Vegetable weights are measured in grams (g).</p>
              </div>

              <!-- Instructions -->
              <div>
                <h3 class="text-lg font-semibold text-white mb-3">Cooking Instructions</h3>
                {% if r.instructions %}
                  {% if r.instructions|length > 0 %}
                    <ol class="space-y-3 text-slate-200 pl-4">
                      {% for step in r.instructions %}
                        <li class="list-decimal">{{ step }}</li>
                      {% endfor %}
                    </ol>
                  {% else %}
                    <p class="text-slate-400">No detailed instructions available.</p>
                  {% endif %}
                {% else %}
                  <p class="text-slate-400">No detailed instructions available.</p>
                {% endif %}
              </div>

              <!-- Source Link -->
              {% if r.sourceUrl %}
                <a href="{{ r.sourceUrl }}" target="_blank" rel="noopener noreferrer" class="recipe-source-btn">
                  üîó View Full Recipe
                </a>
              {% endif %}
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  {% endif %}
</div>
{% endblock %}
